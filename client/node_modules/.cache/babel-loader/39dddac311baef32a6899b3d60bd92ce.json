{"ast":null,"code":"var _jsxFileName = \"/Users/esen/Desktop/MERN stack/client/src/components/blog/DisplayBlog.tsx\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect, useCallback } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { Link, useHistory } from 'react-router-dom';\nimport Input from '../comments/Input';\nimport Comments from '../comments/Comments';\nimport Loading from '../global/Loading';\nimport Pagination from '../global/Pagination';\nimport { createComment, getComments } from '../../redux/actions/commentAction';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst DisplayBlog = ({\n  blog\n}) => {\n  _s();\n\n  const {\n    auth,\n    comments\n  } = useSelector(state => state);\n  const dispatch = useDispatch();\n  const [showComments, setShowComments] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const history = useHistory();\n\n  const handleComment = body => {\n    if (!auth.user || !auth.access_token) return;\n    const data = {\n      content: body,\n      user: auth.user,\n      blog_id: blog._id,\n      blog_user_id: blog.user._id,\n      replyCM: [],\n      createdAt: new Date().toISOString()\n    };\n    setShowComments([data, ...showComments]);\n    dispatch(createComment(data, auth.access_token));\n  };\n\n  useEffect(() => {\n    setShowComments(comments.data);\n  }, [comments.data]);\n  const fetchComments = useCallback(async (id, num = 1) => {\n    setLoading(true);\n    await dispatch(getComments(id, num));\n    setLoading(false);\n  }, [dispatch]);\n  useEffect(() => {\n    if (!blog._id) return;\n    const num = history.location.search.slice(6) || 1;\n    fetchComments(blog._id, num);\n  }, [blog._id, fetchComments, history]);\n\n  const handlePagination = num => {\n    if (!blog._id) return;\n    fetchComments(blog._id, num);\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      className: \"text-center my-3 text-capitalize fs-1\",\n      style: {\n        color: '#ff7a00'\n      },\n      children: blog.title\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"text-end fst-italic\",\n      style: {\n        color: 'teal'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"small\", {\n        children: typeof blog.user !== 'string' && `By: ${blog.user.name}`\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"small\", {\n        className: \"ms-2\",\n        children: new Date(blog.createdAt).toLocaleString()\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      dangerouslySetInnerHTML: {\n        __html: blog.content\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"hr\", {\n      className: \"my-1\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n      style: {\n        color: '#ff7a00'\n      },\n      children: \"\\u2729 Comments \\u2729\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 7\n    }, this), auth.user ? /*#__PURE__*/_jsxDEV(Input, {\n      callback: handleComment\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 11\n    }, this) : /*#__PURE__*/_jsxDEV(\"h5\", {\n      children: [\"Please \", /*#__PURE__*/_jsxDEV(Link, {\n        to: `/login?blog/${blog._id}`,\n        children: \"login\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 18\n      }, this), \" to comment.\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 11\n    }, this), loading ? /*#__PURE__*/_jsxDEV(Loading, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 11\n    }, this) : showComments === null || showComments === void 0 ? void 0 : showComments.map((comment, index) => /*#__PURE__*/_jsxDEV(Comments, {\n      comment: comment\n    }, index, false, {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 11\n    }, this)), comments.total > 1 && /*#__PURE__*/_jsxDEV(Pagination, {\n      total: comments.total,\n      callback: handlePagination\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 74,\n    columnNumber: 5\n  }, this);\n};\n\n_s(DisplayBlog, \"GBTn+wrGjvlL16031wfhr+nBatY=\", false, function () {\n  return [useSelector, useDispatch, useHistory];\n});\n\n_c = DisplayBlog;\nexport default DisplayBlog;\n\nvar _c;\n\n$RefreshReg$(_c, \"DisplayBlog\");","map":{"version":3,"names":["React","useState","useEffect","useCallback","useDispatch","useSelector","Link","useHistory","Input","Comments","Loading","Pagination","createComment","getComments","DisplayBlog","blog","auth","comments","state","dispatch","showComments","setShowComments","loading","setLoading","history","handleComment","body","user","access_token","data","content","blog_id","_id","blog_user_id","replyCM","createdAt","Date","toISOString","fetchComments","id","num","location","search","slice","handlePagination","color","title","name","toLocaleString","__html","map","comment","index","total"],"sources":["/Users/esen/Desktop/MERN stack/client/src/components/blog/DisplayBlog.tsx"],"sourcesContent":["import React, { useState, useEffect, useCallback } from 'react'\nimport { useDispatch, useSelector } from 'react-redux'\nimport { Link, useHistory } from 'react-router-dom'\n\nimport { IBlog, RootStore, IUser, IComment } from '../../utils/TypeScript'\n\nimport Input from '../comments/Input'\nimport Comments from '../comments/Comments'\nimport Loading from '../global/Loading'\nimport Pagination from '../global/Pagination'\n\nimport { \n  createComment, \n  getComments \n} from '../../redux/actions/commentAction'\n\n\ninterface IProps {\n  blog: IBlog\n}\n\nconst DisplayBlog: React.FC<IProps> = ({blog}) => {\n  const { auth, comments } = useSelector((state: RootStore) => state)\n  const dispatch = useDispatch()\n\n  const [showComments, setShowComments] = useState<IComment[]>([])\n  const [loading, setLoading] = useState(false)\n\n  const history = useHistory()\n\n\n  const handleComment = (body: string) => {\n    if(!auth.user || !auth.access_token) return;\n\n    const data = {\n      content: body,\n      user: auth.user,\n      blog_id: (blog._id as string),\n      blog_user_id: (blog.user as IUser)._id,\n      replyCM: [],\n      createdAt: new Date().toISOString()\n    }\n\n    setShowComments([data, ...showComments])\n    dispatch(createComment(data, auth.access_token))\n  }\n\n\n  useEffect(() => {\n    setShowComments(comments.data)\n  },[comments.data])\n\n\n  const fetchComments = useCallback(async(id: string, num = 1) => {\n    setLoading(true)\n    await dispatch(getComments(id, num))\n    setLoading(false)\n  },[dispatch])\n\n\n  useEffect(() => {\n    if(!blog._id) return;\n    const num = history.location.search.slice(6) || 1;\n    fetchComments(blog._id, num)\n  },[blog._id, fetchComments, history])\n\n  const handlePagination = (num: number) => {\n    if(!blog._id) return;\n    fetchComments(blog._id, num)\n  }\n\n\n  return (\n    <div>\n      <h2 className=\"text-center my-3 text-capitalize fs-1\"\n      style={{ color: '#ff7a00' }}>\n        {blog.title}\n      </h2>\n\n      <div className=\"text-end fst-italic\" style={{color: 'teal'}}>\n        <small>\n          {\n            typeof(blog.user) !== 'string' &&\n            `By: ${blog.user.name}`\n          }\n        </small>\n\n        <small className=\"ms-2\">\n          { new Date(blog.createdAt).toLocaleString() }\n        </small>\n      </div>\n\n      <div dangerouslySetInnerHTML={{\n        __html: blog.content\n      }} />\n\n      <hr className=\"my-1\" />\n      <h3 style={{color: '#ff7a00'}}>✩ Comments ✩</h3>\n\n      {\n        auth.user\n        ? <Input callback={handleComment} />\n        : <h5>\n          Please <Link to={`/login?blog/${blog._id}`}>login</Link> to comment.\n        </h5>\n      }\n      \n      {\n        loading\n        ? <Loading />\n        : showComments?.map((comment, index) => (\n          <Comments key={index} comment={comment} />\n        ))\n      }\n\n      {\n        comments.total > 1 &&\n        <Pagination \n        total={comments.total}\n        callback={handlePagination}\n        />\n      }\n    </div>\n  )\n}\n\nexport default DisplayBlog\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}